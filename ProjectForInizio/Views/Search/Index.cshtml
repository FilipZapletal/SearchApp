@using ProjectForInizio.Dtos
@{
    var items = ViewBag.Items as List<SearchItemDto>;
}

<h2 style="text-align:center">Search -> on submi, the app retrieves results from the Google Custom Search API `(first page)`</h2>

<form method="post" action="/Search/Run" style="text-align:center">
    @Html.AntiForgeryToken()
    <label for="query">Search:</label>
    <input id="query" name="query" type="text" required />
    <button type="submit">Submit</button>
</form>

@if (ViewBag.Error != null)
{
    <pre>@ViewBag.Error</pre>
}

@if (items is { Count: > 0 })
{
    <h3 style="text-align:center">Results for: <strong>@ViewBag.Query</strong></h3>
    <ul style="text-align:center">
        @foreach (var it in items)
        {
            <li>
                <a href="@it.Url" target="_blank" rel="noopener">@it.Title</a>
                @if (!string.IsNullOrWhiteSpace(it.Snippet))
                {
                    <span> — @it.Snippet</span>
                }
            </li>
        }
    </ul>
}
@if (ViewBag.DownloadUrl != null)
{
    <p style="text-align:center">Saved: <a href="@ViewBag.DownloadUrl">Download JSON</a></p>
}
